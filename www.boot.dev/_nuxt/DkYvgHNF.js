import{d as k,r as h,j as n,m as d,o as i,b as o,A as y,C as u,b9 as j,N as U,z as R,c as q,w as _,a as x,a7 as D,as as C,F as H,B as J,_ as A,am as O,e as G,dy as K,dz as Q,n as W,P as X}from"./Djz0RQIo.js";import{_ as Y}from"./DLZLUVU_.js";import{_ as Z}from"./CHlI8V3o.js";const ee={class:"mb-4 flex-1"},te={class:"quoted whitespace-pre-wrap"},se=k({__name:"ExpandableText",props:{text:{},maxLength:{default:100}},setup(c){const f=c,e=h(!1),v=n(()=>f.text??""),p=n(()=>!e.value&&v.value.length>f.maxLength),s=n(()=>p.value?v.value.slice(0,f.maxLength)+"...":v.value);function m(){e.value=!e.value}return(r,b)=>(i(),d("div",ee,[o("h4",te,u(s.value),1),v.value.length>c.maxLength?(i(),d("button",{key:0,class:"mt-2 text-sm text-yellow-500 hover:text-yellow-400 underline",onClick:m},u(e.value?"Show less":"Read more"),1)):y("",!0)]))}}),ae={key:0,class:"flex w-full justify-center p-8"},le={key:1},oe={class:"mt-auto flex flex-col items-center gap-3"},ne={class:"flex items-center"},re={class:"ml-1 text-sm text-gray-300"},ie={class:"flex flex-row justify-center gap-2"},ue=["src","alt"],ce={class:"flex flex-col"},de={class:"text-sm"},ge={class:"text-xs text-gray-400"},ve={key:0,class:"text-xs text-gray-400 text-center"},me={key:0,class:"mb-8 flex items-center justify-between"},fe=["disabled"],xe={class:"text-sm text-gray-400"},pe=["disabled"],he={key:1,class:"text-gray-400 text-center"},Se=k({__name:"LandingSectionCourseReviews",props:{layout:{default:"wrap"},enrolledCount:{default:0},courseTitle:{},reviews:{},courseSlug:{},courseIds:{},hideViewMore:{type:Boolean},title:{},subtitle:{},pageSize:{default:9}},setup(c){const{prefetchProfile:f}=j(),e=c,v=U(),p=n(()=>parseInt(v.query.page)||0);R(p,(t,a)=>{s.value=t});const s=h(p.value),m=h(!1),r=h(e.reviews?.Reviews||[]),b=n(()=>e.layout==="wrap"?"mb-2 w-full max-w-6xl flex flex-wrap justify-center gap-4":"mb-8 w-full max-w-4xl grid grid-cols-1 gap-4 lg:grid-cols-3"),T=n(()=>typeof e.courseSlug=="string"&&e.courseSlug.length>0&&typeof e.enrolledCount=="number"&&typeof e.courseTitle=="string"&&e.courseTitle.length>0?`Join ${e.enrolledCount.toLocaleString()} students in the ${e.courseTitle} course`:"Join 822,231 students learning modern backend skills"),L=n(()=>typeof e.courseSlug=="string"&&e.courseSlug.length>0?"Read reviews of their learning experiences":"Connect directly with them and others in our flourishing online community"),z=n(()=>{const t=e.title?.trim();return t?.length?t:T.value}),$=n(()=>{const t=e.subtitle?.trim();return t?.length?t:L.value}),P=n(()=>{const t=s.value*e.pageSize,a=t+e.pageSize;return r.value.slice(t,a)}),g=n(()=>e.reviews?.Total||0),I=n(()=>!!e.courseIds);async function N(){(s.value+1)*e.pageSize<g.value&&(s.value++,(s.value+1)*e.pageSize>r.value.length&&r.value.length<g.value&&await B())}function M(){s.value>0&&s.value--}R(s,(t,a)=>{X({query:t===0?{}:{page:t}})});async function B(){if(!m.value){if(m.value=!0,e.courseSlug)try{const t=r.value.length,a=await K(e.courseSlug,36,t);a?.Reviews&&(r.value=[...r.value,...a.Reviews])}catch(t){console.error("Failed to load more reviews:",t)}finally{m.value=!1}else if(e.courseIds)try{const t=r.value.length,a=await Q(e.courseIds,36,t);a?.Reviews&&(r.value=[...r.value,...a.Reviews])}catch(t){console.error("Failed to load more reviews:",t)}finally{m.value=!1}}}return(t,a)=>{const w=D,E=se,F=Y,S=A,V=Z;return i(),q(V,{id:"course-reviews",class:"bg-image-blue",title:z.value,subtitle:$.value},{main:_(()=>[r.value.length?(i(),d("div",le,[C(t.$slots,"metrics"),o("div",{class:O(b.value)},[(i(!0),d(H,null,J(P.value,l=>(i(),d("div",{key:l.UUID,class:"bg-image-blue flex flex-col border border-yellow-500 p-6 shadow-md shadow-yellow-800 w-full max-w-sm"},[x(E,{text:l.PublicReview,"max-length":100},null,8,["text"]),o("div",oe,[o("div",ne,[x(F,{rating:l.Rating,"tailwind-size":4},null,8,["rating"]),o("span",re,"("+u(l.Rating)+"/5)",1)]),o("div",ie,[x(S,{to:`/u/${l.Handle}`,onMouseenter:ye=>W(f)(l.Handle)},{default:_(()=>[o("img",{width:"48",height:"48",class:"m-1 box-content rounded-full border border-transparent hover:border-yellow-500",loading:"lazy",src:l.ProfileImageURL,alt:`${l.FirstName} ${l.LastName} profile image`},null,8,ue)]),_:2},1032,["to","onMouseenter"]),o("div",ce,[o("p",de,u(l.FirstName)+" "+u(l.LastName),1),o("p",ge,u(l.Location),1)])]),I.value&&l.CourseTitle?(i(),d("p",ve,u(l.CourseTitle),1)):y("",!0)])]))),128))],2),g.value>c.pageSize?(i(),d("div",me,[o("button",{disabled:s.value===0,class:"rounded-sm border border-gray-600 px-4 py-2 text-white hover:border-yellow-500 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:border-gray-600",onClick:M}," ← Prev ",8,fe),o("p",xe," Showing "+u(Math.min(s.value*c.pageSize+1,g.value))+"-"+u(Math.min((s.value+1)*c.pageSize,g.value))+" of "+u(g.value),1),o("button",{disabled:(s.value+1)*c.pageSize>=g.value,class:"rounded-sm border border-gray-600 px-4 py-2 text-white hover:border-yellow-500 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:border-gray-600",onClick:N}," Next → ",8,pe)])):y("",!0),C(t.$slots,"default"),c.hideViewMore?y("",!0):(i(),d("p",he,[a[1]||(a[1]=G(" or ",-1)),x(S,{class:"textlink-secondary",to:{path:"/reviews"}},{default:_(()=>[...a[0]||(a[0]=[o("span",null,"view more reviews",-1)])]),_:1})]))])):(i(),d("div",ae,[x(w,{"is-loading":!0})]))]),_:3},8,["title","subtitle"])}}});export{Se as _};
